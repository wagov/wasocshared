# Microsoft Internet Control Message Protocol (ICMP) Remote Code Execution (RCE) Vulnerability- 20230315002

## Overview
The WA SOC has received information regarding a new vulnerability found in Microsoft Internet Control Message Protocol (ICMP) which elevates the risks to organisations.

## What is the vulnerability?
[**CVE-2023-23415**](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-23415) - Internet Control Message Protocol (ICMP) Remote Code Execution Vulnerability

An attacker could send a low-level protocol error containing a fragmented IP packet inside another ICMP packet in its header to the target machine. To trigger the vulnerable code path, an application on the target must be bound to a raw socket.

## What is vulnerable? 
The vulnerability affects the following products:



| No. 	| Product                                                                                  	| Impact                  	| Severity 	| Build number     	|
|-----	|------------------------------------------------------------------------------------------	|-------------------------	|----------	|------------------	|
| 1   	| Windows Server 2012   R2 (Server Core installation)                                      	| Remote Code   Execution 	| Critical 	| 6.3.9600.20865   	|
| 2   	| Windows Server 2012 R2 (Server Core   installation)                                      	| Remote Code Execution   	| Critical 	| 6.3.9600.20865   	|
| 3   	| Windows Server 2012 R2                                                                   	| Remote Code Execution   	| Critical 	| 6.3.9600.20865   	|
| 4   	| Windows Server 2012 R2                                                                   	| Remote Code Execution   	| Critical 	| 6.3.9600.20865   	|
| 5   	| Windows Server 2012 (Server Core   installation)                                         	| Remote Code Execution   	| Critical 	| 6.2.9200.24168   	|
| 6   	| Windows Server 2012 (Server Core   installation)                                         	| Remote Code Execution   	| Critical 	| 6.2.9200.24168   	|
| 7   	| Windows Server 2012                                                                      	| Remote Code Execution   	| Critical 	| 6.2.9200.24168   	|
| 8   	| Windows Server 2012                                                                      	| Remote Code Execution   	| Critical 	| 6.2.9200.24168   	|
| 9   	| Windows Server 2008 R2 for x64-based   Systems Service Pack 1 (Server Core installation) 	| Remote Code Execution   	| Critical 	| 6.1.7601.26415   	|
| 10  	| Windows Server 2008 R2 for x64-based   Systems Service Pack 1 (Server Core installation) 	| Remote Code Execution   	| Critical 	| 6.1.7601.26415   	|
| 11  	| Windows Server 2008 R2 for x64-based   Systems Service Pack 1                            	| Remote Code Execution   	| Critical 	| 6.1.7601.26415   	|
| 12  	| Windows Server 2008 R2 for x64-based   Systems Service Pack 1                            	| Remote Code Execution   	| Critical 	| 6.1.7601.26415   	|
| 13  	| Windows Server 2008 for x64-based Systems   Service Pack 2 (Server Core installation)    	| Remote Code Execution   	| Critical 	| 6.0.6003.21966   	|
| 14  	| Windows Server 2008 for x64-based Systems   Service Pack 2 (Server Core installation)    	| Remote Code Execution   	| Critical 	| 6.0.6003.21966   	|
| 15  	| Windows Server 2008 for x64-based Systems   Service Pack 2                               	| Remote Code Execution   	| Critical 	| 6.0.6003.21966   	|
| 16  	| Windows Server 2008 for x64-based Systems   Service Pack 2                               	| Remote Code Execution   	| Critical 	| 6.0.6003.21966   	|
| 17  	| Windows Server 2008 for 32-bit Systems   Service Pack 2 (Server Core installation)       	| Remote Code Execution   	| Critical 	| 6.0.6003.21966   	|
| 18  	| Windows Server 2008 for 32-bit Systems   Service Pack 2 (Server Core installation)       	| Remote Code Execution   	| Critical 	| 6.0.6003.21966   	|
| 19  	| Windows Server 2008 for 32-bit Systems   Service Pack 2                                  	| Remote Code Execution   	| Critical 	| 6.0.6003.21966   	|
| 20  	| Windows Server 2008 for 32-bit Systems   Service Pack 2                                  	| Remote Code Execution   	| Critical 	| 6.0.6003.21966   	|
| 21  	| Windows Server 2016 (Server Core   installation)                                         	| Remote Code Execution   	| Critical 	| 10.0.14393.5786  	|
| 22  	| Windows Server 2016                                                                      	| Remote Code Execution   	| Critical 	| 10.0.14393.5786  	|
| 23  	| Windows 10 Version 1607 for x64-based   Systems                                          	| Remote Code Execution   	| Critical 	| 10.0.14393.5786  	|
| 24  	| Windows 10 Version 1607 for 32-bit   Systems                                             	| Remote Code Execution   	| Critical 	| 10.0.14393.5786  	|
| 25  	| Windows 10 for x64-based Systems                                                         	| Remote Code Execution   	| Critical 	| 10.0.10240.19805 	|
| 26  	| Windows 10 for 32-bit Systems                                                            	| Remote Code Execution   	| Critical 	| 10.0.10240.19805 	|
| 27  	| Windows 10 Version 22H2 for 32-bit   Systems                                             	| Remote Code Execution   	| Critical 	| 10.0.19045.2728  	|
| 28  	| Windows 10 Version 22H2 for ARM64-based   Systems                                        	| Remote Code Execution   	| Critical 	| 10.0.19045.2728  	|
| 29  	| Windows 10 Version 22H2 for x64-based   Systems                                          	| Remote Code Execution   	| Critical 	| 10.0.19045.2728  	|
| 30  	| Windows 11 Version 22H2 for x64-based   Systems                                          	| Remote Code Execution   	| Critical 	| 10.0.22000.1413  	|
| 31  	| Windows 11 Version 22H2 for ARM64-based   Systems                                        	| Remote Code Execution   	| Critical 	| 10.0.22000.1413  	|
| 32  	| Windows 10 Version 21H2 for x64-based   Systems                                          	| Remote Code Execution   	| Critical 	| 10.0.19044.2728  	|
| 33  	| Windows 10 Version 21H2 for ARM64-based   Systems                                        	| Remote Code Execution   	| Critical 	| 10.0.19044.2728  	|
| 34  	| Windows 10 Version 21H2 for 32-bit   Systems                                             	| Remote Code Execution   	| Critical 	| 10.0.19044.2728  	|
| 35  	| Windows 11 version 21H2 for ARM64-based   Systems                                        	| Remote Code Execution   	| Critical 	| 10.0.22000.1696  	|
| 36  	| Windows 11 version 21H2 for x64-based   Systems                                          	| Remote Code Execution   	| Critical 	| 10.0.22000.1696  	|
| 37  	| Windows 10 Version 20H2 for ARM64-based   Systems                                        	| Remote Code Execution   	| Critical 	| 10.0.19042.2728  	|
| 38  	| Windows 10 Version 20H2 for 32-bit   Systems                                             	| Remote Code Execution   	| Critical 	| 10.0.19042.2728  	|
| 39  	| Windows 10 Version 20H2 for x64-based   Systems                                          	| Remote Code Execution   	| Critical 	| 10.0.19042.2728  	|
| 40  	| Windows Server 2022 (Server Core   installation)                                         	| Remote Code Execution   	| Critical 	| 10.0.20348.1607  	|
| 41  	| Windows Server 2022 (Server Core   installation)                                         	| Remote Code Execution   	| Critical 	| 10.0.20348.1600  	|
| 42  	| Windows Server 2022                                                                      	| Remote Code Execution   	| Critical 	| 10.0.20348.1607  	|
| 43  	| Windows Server 2022                                                                      	| Remote Code Execution   	| Critical 	| 10.0.20348.1600  	|
| 44  	| Windows Server 2019 (Server Core   installation)                                         	| Remote Code Execution   	| Critical 	| 10.0.17763.4131  	|
| 45  	| Windows Server 2019                                                                      	| Remote Code Execution   	| Critical 	| 10.0.17763.4131  	|
| 46  	| Windows 10 Version 1809 for ARM64-based   Systems                                        	| Remote Code Execution   	| Critical 	| 10.0.17763.4131  	|
| 47  	| Windows 10 Version 1809 for x64-based   Systems                                          	| Remote Code Execution   	| Critical 	| 10.0.17763.4131  	|
| 48  	| Windows 10 Version 1809 for 32-bit   Systems                                             	| Remote Code Execution   	| Critical 	| 10.0.17763.4131  	|

## Recommendation
The WA SOC recommends administrators apply the solutions as per vendor instructions to all affected products.

## Additional References:
* [CVE-2023-23415 - Security Update Guide - Microsoft - Internet Control Message Protocol (ICMP) Remote Code Execution Vulnerability](https://msrc.microsoft.com/update-guide/vulnerability/CVE-2023-23415)