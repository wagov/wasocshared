# QNAP Critical Vulnerability - 20250124002

## Overview

The WA SOC has been made aware of a heap-based buffer overflow flaw found in the rsync daemon. The vulnerability include improper handling of attacker-controlled checksum lengths (s2length) in the code. When MAX_DIGEST_LEN exceeds the fixed SUM_LENGTH (16 bytes), an attacker can write out of bounds in the sum2 buffer.

## What is vulnerable?

| Product(s) Affected | Version(s)               | CVE                                                                                                                                     | CVSS v4/v3       | Severity               |
| ------------------- | ------------------------ | --------------------------------------------------------------------------------------------------------------------------------------- | ---------------- | ---------------------- |
| HBS 3 Hybrid Backup Sync            | 25.1.x | [CVE-2024-12084](https://nvd.nist.gov/vuln/detail/CVE-2024-12084) <br>[CVE-2024-12085](https://nvd.nist.gov/vuln/detail/CVE-2024-12085)| 9.8 <br> 7.5 | **Critical** <br> High |

## What has been observed?

There is no evidence of exploitation affecting Western Australian Government networks at the time of publishing.

## Recommendation

The WA SOC recommends administrators apply the solutions as per vendor instructions to all affected devices within expected timeframe of *48 hours...* (refer [Patch Management](../guidelines/patch-management.md)):

- QNAP: <https://www.qnap.com/en-au/security-advisory/qsa-25-02>

## Additional References

- Bleepingcomputer: <https://www.bleepingcomputer.com/news/security/qnap-fixes-six-rsync-vulnerabilities-in-hbs-nas-backup-recovery-app/>
